<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒêi·ªÅu K·ª≥ Di·ªáu ƒê√™m Gi√°ng Sinh</title>
    
    <!-- Th√™m Favicon h√¨nh c√¢y th√¥ng Noel -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéÑ</text></svg>">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Mountains+of+Christmas:wght@400;700&family=Nunito:wght@300;600&display=swap" rel="stylesheet">
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root { --primary: #d42426; --gold: #ffd700; }
        body {
            font-family: 'Nunito', sans-serif;
            overflow: hidden;
            background-color: #000;
            perspective: 1000px;
            cursor: none; /* ·∫®n con tr·ªè m·∫∑c ƒë·ªãnh ƒë·ªÉ d√πng con tr·ªè ph√©p thu·∫≠t */
        }

        /* --- BACKGROUND & LAYERS --- */
        .bg-layer {
            position: absolute; top: -5%; left: -5%; width: 110%; height: 110%;
            background-image: url('https://images.unsplash.com/photo-1511268011861-691ed210aae8?w=1200&h=800&fit=crop&q=80');
            background-size: cover; background-position: center;
            z-index: -2; filter: brightness(0.6);
            transition: transform 0.1s ease-out;
        }

        /* --- CON TR·ªé PH√âP THU·∫¨T (Custom Cursor) --- */
        #customCursor {
            position: fixed; pointer-events: none; z-index: 9999;
            width: 20px; height: 20px;
            border-radius: 50%;
            background: rgba(255, 215, 0, 0.5);
            box-shadow: 0 0 10px #ffd700, 0 0 20px #ffd700;
            transform: translate(-50%, -50%);
            mix-blend-mode: screen;
            transition: width 0.2s, height 0.2s;
        }
        body:active #customCursor { width: 15px; height: 15px; background: rgba(255, 255, 255, 0.8); }

        /* --- H·ªòP QU√Ä (Intro) --- */
        #giftContainer {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 50; cursor: pointer;
            transition: all 0.5s ease-in-out;
        }
        .gift-box {
            font-size: 80px;
            filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.6));
            animation: bounce-gift 2s infinite ease-in-out;
        }
        .gift-text {
            color: #ffd700; font-family: 'Mountains of Christmas', cursive;
            font-size: 24px; text-align: center; margin-top: 10px;
            text-shadow: 0 0 5px black; opacity: 0.9;
            animation: pulse-text 2s infinite;
        }
        @keyframes bounce-gift {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-20px) scale(1.1); }
        }
        @keyframes pulse-text { 0%, 100% { opacity: 0.6; } 50% { opacity: 1; } }

        /* --- THI·ªÜP CH√çNH (Card) --- */
        #cardContainer {
            opacity: 0; transform: scale(0.8) rotateX(10deg);
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1); /* Hi·ªáu ·ª©ng n·∫£y khi hi·ªán */
            pointer-events: none; /* Kh√¥ng b·∫•m ƒë∆∞·ª£c khi ch∆∞a hi·ªán */
        }
        #cardContainer.visible {
            opacity: 1; transform: scale(1) rotateX(0deg);
            pointer-events: auto;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.25);
            box-shadow: 0 20px 50px rgba(0,0,0,0.6), inset 0 0 20px rgba(255,255,255,0.1);
        }

        .title-font { font-family: 'Great Vibes', cursive; text-shadow: 0 0 15px #ffd700; }
        .countdown-font { font-family: 'Mountains of Christmas', cursive; }
        .santa-gif { mix-blend-mode: multiply; filter: drop-shadow(0 0 15px rgba(255,255,255,0.5)); }

        /* Animation class ƒë·ªÉ ·∫©n h·ªôp qu√† */
        .fade-out-zoom { opacity: 0; transform: translate(-50%, -50%) scale(3) !important; pointer-events: none; }
    </style>
</head>
<body class="h-screen w-full flex items-center justify-center">

    <div id="customCursor"></div>
    <div id="bgLayer" class="bg-layer"></div>
    <canvas id="mainCanvas" class="absolute top-0 left-0 w-full h-full pointer-events-none z-1"></canvas>

    <!-- M√ÄN 1: H·ªòP QU√Ä B√ç M·∫¨T -->
    <div id="giftContainer" onclick="openGift()">
        <div class="gift-box">üéÅ</div>
        <div class="gift-text">Nh·∫•n ƒë·ªÉ m·ªü qu√†</div>
    </div>

    <!-- M√ÄN 2: T·∫§M THI·ªÜP -->
    <div id="cardContainer" class="relative z-10 p-4" style="transform-style: preserve-3d;">
        <div class="glass-panel rounded-3xl p-8 md:p-10 text-center max-w-2xl mx-auto relative overflow-hidden group">
            <!-- Header -->
            <h1 class="title-font text-6xl md:text-8xl text-yellow-300 mb-2">Merry Christmas</h1>
            <p class="text-white/90 text-lg md:text-xl font-light mb-6 tracking-wider">
                Gi√°ng Sinh An L√†nh & H·∫°nh Ph√∫c
            </p>

            <!-- Santa -->
            <div class="relative h-60 md:h-72 flex items-center justify-center mb-6">
                <div class="absolute w-56 h-56 bg-yellow-200/20 rounded-full blur-3xl animate-pulse"></div>
                <img src="https://anh.quatructuyen.com/media/wysiwyg/giang-sinh/giphy.gif" alt="Santa" 
                     class="santa-gif h-full object-contain relative z-10 hover:scale-110 transition-transform duration-500">
            </div>

            <!-- Countdown -->
            <div class="grid grid-cols-4 gap-3 text-white mb-6 border-t border-white/20 pt-6">
                <div class="glass-panel rounded-lg p-2"><div id="d" class="text-3xl font-bold countdown-font text-yellow-300">00</div><div class="text-[10px] uppercase">Ng√†y</div></div>
                <div class="glass-panel rounded-lg p-2"><div id="h" class="text-3xl font-bold countdown-font">00</div><div class="text-[10px] uppercase">Gi·ªù</div></div>
                <div class="glass-panel rounded-lg p-2"><div id="m" class="text-3xl font-bold countdown-font">00</div><div class="text-[10px] uppercase">Ph√∫t</div></div>
                <div class="glass-panel rounded-lg p-2"><div id="s" class="text-3xl font-bold countdown-font text-red-300">00</div><div class="text-[10px] uppercase">Gi√¢y</div></div>
            </div>

            <!-- Music Button -->
            <button onclick="toggleMusic()" id="musicBtn" class="rounded-full border border-white/40 text-white px-6 py-2 hover:bg-white/20 flex items-center gap-3 mx-auto transition-all backdrop-blur-sm">
                <i class="fas fa-music"></i> <span id="musicText">Ph√°t nh·∫°c</span>
            </button>
        </div>
    </div>

    <audio id="bgMusic" loop>
        <!-- Jingle Bells (Kevin MacLeod) -->
        <source src="https://file.matbao.support/system/data/default_home_folder/Hinh/duytv/giangsinh.mp3" type="audio/mpeg">
    </audio>

    <script>
        // --- C·∫§U H√åNH ---
        const canvas = document.getElementById('mainCanvas');
        const ctx = canvas.getContext('2d');
        let width = window.innerWidth;
        let height = window.innerHeight;
        canvas.width = width; canvas.height = height;

        // --- TR·∫†NG TH√ÅI ---
        let mouse = { x: -100, y: -100 }; // V·ªã tr√≠ chu·ªôt
        let isGiftOpened = false;

        // --- H·ªÜ TH·ªêNG H·∫†T (Particles System) ---
        // Ch√∫ng ta d√πng chung 1 h·ªá th·ªëng ƒë·ªÉ qu·∫£n l√Ω Tuy·∫øt, B·ª•i ti√™n, v√† Ph√°o gi·∫•y
        const particles = []; 
        const snows = [];

        // 1. CLASS TUY·∫æT (Interactive Snow)
        class Snowflake {
            constructor() { this.init(true); }
            init(firstTime = false) {
                this.x = Math.random() * width;
                this.y = firstTime ? Math.random() * height : -15;
                this.z = Math.random() * 0.8 + 0.2; // Depth
                this.size = this.z * 4 + 1;
                this.velY = this.z * 1.5 + 0.5; // T·ªëc ƒë·ªô r∆°i
                this.velX = 0; // T·ªëc ƒë·ªô ngang (gi√≥ + t√°c ƒë·ªông chu·ªôt)
                this.opacity = this.z * 0.8;
                this.angle = Math.random() * 6.28;
                this.isCrystal = this.z > 0.7; // B√¥ng to s·∫Ω v·∫Ω chi ti·∫øt
            }
            update() {
                // T∆∞∆°ng t√°c chu·ªôt: ƒê·∫©y tuy·∫øt ra xa chu·ªôt
                const dx = this.x - mouse.x;
                const dy = this.y - mouse.y;
                const dist = Math.sqrt(dx*dx + dy*dy);
                const forceRadius = 150; // B√°n k√≠nh t√°c ƒë·ªông

                if (dist < forceRadius) {
                    const force = (forceRadius - dist) / forceRadius; // L·ª±c m·∫°nh h∆°n khi g·∫ßn t√¢m
                    const angle = Math.atan2(dy, dx);
                    this.velX += Math.cos(angle) * force * 1.5; // ƒê·∫©y ngang
                    this.velY += Math.sin(angle) * force * 1.5; // ƒê·∫©y d·ªçc
                }

                // V·∫≠t l√Ω b√¨nh th∆∞·ªùng
                this.velX *= 0.95; // Ma s√°t kh√¥ng kh√≠ (gi·∫£m d·∫ßn l·ª±c ƒë·∫©y)
                this.y += this.velY;
                this.x += this.velX + Math.sin(this.angle) * 0.3; // L·∫Øc l∆∞ t·ª± nhi√™n
                this.angle += 0.02;

                // Reset
                if (this.y > height + 10 || this.x < -20 || this.x > width + 20) this.init();
            }
            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.globalAlpha = this.opacity;
                ctx.fillStyle = "white";
                
                if (this.isCrystal) {
                    // V·∫Ω b√¥ng tuy·∫øt ƒë∆°n gi·∫£n (d·∫•u c·ªông xoay)
                    ctx.rotate(this.angle);
                    ctx.fillRect(-this.size/2, -this.size/8, this.size, this.size/4);
                    ctx.fillRect(-this.size/8, -this.size/2, this.size/4, this.size);
                } else {
                    // V·∫Ω ch·∫•m tr√≤n m·ªù
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size/2, 0, Math.PI*2);
                    ctx.fill();
                }
                ctx.restore();
            }
        }

        // 2. CLASS B·ª§I TI√äN (Magic Dust - Mouse Trail)
        class MagicDust {
            constructor(x, y) {
                this.x = x; this.y = y;
                this.size = Math.random() * 3 + 1;
                this.vx = (Math.random() - 0.5) * 2;
                this.vy = (Math.random() - 0.5) * 2;
                this.life = 1; // Tu·ªïi th·ªç (1 -> 0)
                this.color = `hsl(${Math.random()*40 + 40}, 100%, 70%)`; // V√†ng/Cam
            }
            update() {
                this.x += this.vx;
                this.y += this.vy + 1; // R∆°i nh·∫π
                this.life -= 0.02; // M·ªù d·∫ßn
            }
            draw() {
                ctx.globalAlpha = this.life;
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI*2);
                ctx.fill();
            }
        }

        // 3. CLASS PH√ÅO GI·∫§Y (Confetti)
        class Confetti {
            constructor(x, y) {
                this.x = x; this.y = y;
                this.vx = (Math.random() - 0.5) * 15; // N·ªï m·∫°nh ra xung quanh
                this.vy = (Math.random() - 1) * 15 - 5; // B·∫Øn l√™n tr√™n
                this.gravity = 0.5;
                this.color = `hsl(${Math.random()*360}, 100%, 50%)`;
                this.rotation = Math.random() * 6.28;
                this.life = 150; // T·ªìn t·∫°i l√¢u h∆°n b·ª•i ti√™n
            }
            update() {
                this.vy += this.gravity;
                this.vx *= 0.96; // S·ª©c c·∫£n
                this.x += this.vx;
                this.y += this.vy;
                this.rotation += 0.1;
                this.life--;
            }
            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation);
                ctx.fillStyle = this.color;
                ctx.fillRect(-3, -3, 6, 6);
                ctx.restore();
            }
        }

        // --- KH·ªûI T·∫†O ---
        // ƒê√É TƒÇNG S·ªê L∆Ø·ª¢NG TUY·∫æT L√äN 450
        for (let i = 0; i < 450; i++) snows.push(new Snowflake());

        // --- MAIN LOOP ---
        function animate() {
            ctx.clearRect(0, 0, width, height);

            // 1. V·∫Ω Tuy·∫øt
            snows.forEach(s => { s.update(); s.draw(); });

            // 2. V·∫Ω H·∫°t hi·ªáu ·ª©ng (B·ª•i ti√™n + Ph√°o gi·∫•y)
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.update();
                p.draw();
                if (p.life <= 0) particles.splice(i, 1); // X√≥a h·∫°t ch·∫øt
            }

            requestAnimationFrame(animate);
        }
        animate();

        // --- EVENT LISTENERS ---
        
        // C·∫≠p nh·∫≠t v·ªã tr√≠ chu·ªôt & T·∫°o b·ª•i ti√™n
        document.addEventListener('mousemove', (e) => {
            mouse.x = e.clientX;
            mouse.y = e.clientY;

            // Custom Cursor
            const cursor = document.getElementById('customCursor');
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY + 'px';

            // T·∫°o b·ª•i ti√™n khi di chuy·ªÉn
            for(let i=0; i<3; i++) {
                particles.push(new MagicDust(mouse.x, mouse.y));
            }

            // 3D Parallax n·ªÅn
            if (isGiftOpened) {
                const moveX = (window.innerWidth/2 - e.clientX) / 30;
                const moveY = (window.innerHeight/2 - e.clientY) / 30;
                document.getElementById('bgLayer').style.transform = `scale(1.1) translate(${moveX}px, ${moveY}px)`;
                
                // Tilt Card
                const card = document.getElementById('cardContainer');
                const rotateY = (e.clientX - window.innerWidth/2) / 30; 
                const rotateX = (window.innerHeight/2 - e.clientY) / 20;
                card.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
            }
        });

        window.addEventListener('resize', () => {
            width = window.innerWidth; height = window.innerHeight;
            canvas.width = width; canvas.height = height;
        });

        // --- LOGIC GAME ---

        function openGift() {
            if(isGiftOpened) return;
            isGiftOpened = true;

            // 1. ·∫®n h·ªôp qu√†
            const giftBox = document.getElementById('giftContainer');
            giftBox.classList.add('fade-out-zoom');

            // 2. N·ªï ph√°o gi·∫•y
            const rect = giftBox.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            for(let i=0; i<100; i++) {
                particles.push(new Confetti(centerX, centerY));
            }

            // 3. Hi·ªán thi·ªáp sau 0.5s
            setTimeout(() => {
                document.getElementById('cardContainer').classList.add('visible');
                // T·ª± ƒë·ªông ph√°t nh·∫°c n·∫øu tr√¨nh duy·ªát cho ph√©p (th∆∞·ªùng c·∫ßn user interaction tr∆∞·ªõc ƒë√≥)
                // toggleMusic(); 
            }, 300);
        }

        // --- COUNTDOWN & MUSIC (Gi·ªØ nguy√™n logic c≈©) ---
        function updateCountdown() {
            const now = new Date();
            const currentYear = now.getFullYear();
            let xmas = new Date(currentYear, 11, 25);
            if (now.getMonth() == 11 && now.getDate() > 25) xmas.setFullYear(currentYear + 1);
            const diff = xmas - now;
            const d = Math.floor(diff / (1000 * 60 * 60 * 24));
            const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const s = Math.floor((diff % (1000 * 60)) / 1000);
            document.getElementById('d').innerText = d<10?'0'+d:d;
            document.getElementById('h').innerText = h<10?'0'+h:h;
            document.getElementById('m').innerText = m<10?'0'+m:m;
            document.getElementById('s').innerText = s<10?'0'+s:s;
        }
        setInterval(updateCountdown, 1000); updateCountdown();

        const audio = document.getElementById('bgMusic');
        let isPlaying = false;
        function toggleMusic() {
            if (isPlaying) {
                audio.pause();
                document.getElementById('musicBtn').classList.remove('bg-white/30');
                document.getElementById('musicText').innerText = "Ph√°t nh·∫°c";
            } else {
                audio.play();
                document.getElementById('musicBtn').classList.add('bg-white/30');
                document.getElementById('musicText').innerText = "ƒêang ph√°t...";
            }
            isPlaying = !isPlaying;
        }
    </script>
</body>
</html>
